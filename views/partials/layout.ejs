<!-- // views/partials/layout.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || 'ระบบจัดการ' %></title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <!-- 1. SweetAlert2 (CSS & JS) -->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    
    <!-- 2. Header (Navbar) -->
    <% if (user) { %>
        <%- include('header', { user: user }) %>
    <% } %>

    <!-- 3. เนื้อหาหลัก (Body) -->
    <main class="container mt-4">
        <%- body %>
    </main>

    <!-- 4. สคริปต์พื้นฐาน (jQuery, Bootstrap) -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
    
    <!-- 5. [สำคัญ!] ติดตั้ง Global Toast (ให้ทุกหน้าเรียกใช้ได้) -->
    <script>
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer);
                toast.addEventListener('mouseleave', Swal.resumeTimer);
            }
        });
    </script>

    <!-- 6. สคริปต์ย่อยของแต่ละหน้า (ที่จะมี Fetch) -->
    <% if (typeof script !== 'undefined' && script) { %>
        <%- script %> 
    <% } %>

</body>
</html>